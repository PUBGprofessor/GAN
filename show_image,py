from model import *
import os
import torch
from torchvision.utils import save_image

class config:
    batch_size = 5
    epoch = 2
    version = "v3.1"
save_dir = os.path.join('./saved_models', config.version)
output_dir = os.path.join('./output_images', config.version + "_epoch" +str(config.epoch))
if not os.path.exists(output_dir):
    os.makedirs(output_dir)

device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
G = G().to(device)
model_path_G = os.path.join(save_dir, f'G_epoch_{config.epoch}.pth')
G.load_state_dict(torch.load(model_path_G))
G.eval()



Imgs = G.getImage("test", batch_size=5)
for ind, i in enumerate(Imgs):
    save_image(i, os.path.join(output_dir, "test{}.png".format(ind)), normalize=True)